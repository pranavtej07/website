"0","library(ggplot2)"
"0","library(plotly)"
"0","library(dplyr)"
"0",""
"0","# Load the dataset"
"0","dataset <- read.csv(""dataset.csv"")"
"0",""
"0","# Rename columns with simpler names"
"0","names(dataset) <- c(""Country"", ""Total_payment"", ""Income_tax"", ""Employee_social_security_contributions"", ""Gross_wage_earnings"", ""Wages_earning_After_Taxes"", ""Tax_amount"")"
"0",""
"0","# Calculate Total_payment(%)"
"0","dataset$Total_payment <- dataset$Income_tax + dataset$Employee_social_security_contributions"
"0",""
"0","# Create the bar graph"
"0","p <- ggplot(dataset, aes(x = reorder(Country, Total_payment), y = Total_payment, "
"0","                         text = paste(Country, ""<br>"","
"0","                                    ""Total Payment (%)<br>"","
"0","                                      Total_payment, ""%""))) +"
"0","  geom_bar(stat = ""identity"", aes(fill = ""Total Payment (%)"")) +"
"0","  geom_bar(stat = ""identity"", aes(y = Income_tax, fill = ""Income Tax (%)"","
"0","                                  text = paste(Country, ""<br>"","
"0","                                              ""Income Tax (%)<br>"","
"0","                                                Income_tax, ""%""))) +"
"0","  geom_bar(stat = ""identity"", aes(y = Employee_social_security_contributions, fill = ""Employee Social Security Contributions (%)"","
"0","                                  text = paste(Country, ""<br>"","
"0","                                              ""Employee Social Security Contributions (%)<br>"","
"0","                                                Employee_social_security_contributions, ""%""))) +"
"0","  scale_fill_manual(values = c(""Total Payment (%)"" = ""#7B68EE"", ""Income Tax (%)"" = ""#FFA07A"", ""Employee Social Security Contributions (%)"" = ""#20B2AA"")) +"
"0","  labs(title = ""Income Tax and Employee Social Security Contributions by Country"","
"0","       x = ""Country"","
"0","       y = ""Percentage (%)"","
"0","       fill = """") +"
"0","  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +"
"0","  theme(legend.position = ""top"") +"
"0","  guides(fill = guide_legend(title = ""Type of Tax"")) "
"0",""
"0","# Add interactivity using plotly"
"0","p <- ggplotly(p, tooltip = ""text"")"
"0",""
"0","# Display the plot"
"0","p"
